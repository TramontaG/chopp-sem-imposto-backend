{"version":3,"file":"Events.js","names":["_express","require","_SafeRequest","_JWT","V","_interopRequireWildcard","_eventsController","_interopRequireDefault","_SafeDatabaseTransaction","_cryptoService","_userController","_verifyHMAC","_confirmationMessage","_mimeTypes","_Messages","_expressFormData","_bucketStorage","_promises","e","__esModule","default","t","WeakMap","r","n","o","i","f","__proto__","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","EventsRouter","Router","post","useJWT","safeRequest","req","res","name","description","location","organizer","date","bannerUrl","validate","string","nullable","body","createEventTransaction","eventsController","createEvent","Date","getTime","safeReturnTransaction","id","data","any","updateTransaction","updateEvent","useHMAC","json","payload","action","eventId","userId","eventCofirmationCryptoService","decrypt","console","log","interestedTransaction","userController","userInterestedInEvent","transactionError","FAIL_REASONS","OPERATION_FORBIDDEN","query","encrypt","send","decrypted","valid","error","events","getUpcomingEvents","getEventsForToday","getPastEvents","formData","parse","files","medias","length","BAD_REQUEST","uploadPromises","map","file","fileName","originalFilename","filePath","folder","uploadToBucket","fs","readFile","path","uploadedFiles","Promise","all","success","attendees","getEventById","radom_atendee","Math","round","random","atendeeData","getUserById","result","updateUser","confirmed","user","phone","phoneNumber","event","url","type","Boolean","mime","lookup","includes","allConfirmedUsers","getAllUsers","allConfirmedContacts","sanitizedPhone","replace","contactId","messages","eventConfirmation1","eventConfirmation2","eventConfirmation3","eventConfirmation4","postMessages","inviteFriendMessage1","inviteFriendMessage2","inviteFriendMessage3","sendMessageToContactList","contacts","post_messages","_default","exports"],"sources":["../../src/Router/Events.ts"],"sourcesContent":["import { json, Router } from \"express\";\nimport { safeRequest } from \"../Util/SafeRequest\";\nimport { useJWT } from \"../JWT\";\nimport * as V from \"../Util/ZodValidation\";\nimport eventsController from \"../database/controllers/eventsController.\";\nimport {\n  FAIL_REASONS,\n  safeReturnTransaction,\n  transactionError,\n} from \"../Util/SafeDatabaseTransaction\";\nimport type { DatabaseFriendlyEntityModel } from \"../database/schemas\";\nimport { eventCofirmationCryptoService } from \"../Util/crypto-service\";\nimport userController from \"../database/controllers/userController\";\nimport { useHMAC } from \"../JWT/verifyHMAC\";\nimport { sendMessageToContactList } from \"../Kozz-Module/Methods/confirmationMessage\";\nimport mime from \"mime-types\";\nimport {\n  eventConfirmation1,\n  eventConfirmation2,\n  eventConfirmation3,\n  eventConfirmation4,\n  inviteFriendMessage1,\n  inviteFriendMessage2,\n  inviteFriendMessage3,\n} from \"../Kozz-Module/Messages\";\nimport formData from \"express-form-data\";\nimport { uploadToBucket } from \"../CDN/bucketStorage\";\nimport fs from \"fs/promises\";\n\nconst EventsRouter = Router();\n\nEventsRouter.post(\n  \"/create_event\",\n  useJWT([\"events_create\"]),\n  safeRequest(async (req, res) => {\n    const { name, description, location, organizer, date, bannerUrl } =\n      V.validate(\n        {\n          name: V.string,\n          description: V.string,\n          location: V.string,\n          organizer: V.string.nullable(),\n          date: V.string,\n          bannerUrl: V.string.nullable(),\n        },\n        req.body\n      );\n\n    const createEventTransaction = await eventsController.createEvent({\n      name,\n      description,\n      date: new Date(date).getTime(),\n      location,\n      organizer,\n      bannerUrl,\n    });\n\n    return safeReturnTransaction(createEventTransaction);\n  })\n);\n\nEventsRouter.post(\n  \"/update_event\",\n  useJWT([\"events_create\"]),\n  safeRequest(async (req, res) => {\n    const { id, data } = V.validate(\n      {\n        id: V.string,\n        data: V.any,\n      },\n      req.body\n    );\n\n    const updateTransaction = await eventsController.updateEvent(\n      id,\n      data as Partial<DatabaseFriendlyEntityModel<\"event\">>\n    );\n\n    return safeReturnTransaction(updateTransaction);\n  })\n);\n\nEventsRouter.post(\n  \"/confirm\",\n  useHMAC,\n  json(),\n  safeRequest(async (req, res) => {\n    const { payload } = V.validate(\n      {\n        payload: V.string,\n      },\n      req.body\n    );\n\n    const { action, eventId, userId } =\n      eventCofirmationCryptoService.decrypt(payload);\n\n    console.log({ action, eventId, userId });\n\n    if (action === \"confirm\") {\n      const interestedTransaction = await userController.userInterestedInEvent(\n        userId,\n        eventId\n      );\n      return safeReturnTransaction(interestedTransaction);\n    } else {\n      return safeReturnTransaction(\n        transactionError(FAIL_REASONS.OPERATION_FORBIDDEN)\n      );\n    }\n  })\n);\n\nEventsRouter.get(\n  \"/confirmation_payload\",\n  useJWT([\"admin\"]),\n  safeRequest(async (req, res) => {\n    const { userId, eventId } = V.validate(\n      {\n        userId: V.string,\n        eventId: V.string,\n      },\n      req.query as Record<string, string>\n    );\n\n    const payload = eventCofirmationCryptoService.encrypt({\n      action: \"confirm\",\n      eventId,\n      userId,\n    });\n\n    res.send({\n      payload,\n    });\n  })\n);\n\nEventsRouter.post(\n  \"/check_payload\",\n  useJWT([\"admin\"]),\n  safeRequest(async (req, res) => {\n    const { payload } = V.validate(\n      {\n        payload: V.string,\n      },\n      req.body\n    );\n\n    try {\n      const decrypted = eventCofirmationCryptoService.decrypt(payload);\n      res.send({\n        valid: true,\n        data: decrypted,\n      });\n    } catch (error) {\n      res.send({\n        valid: false,\n        error: \"Invalid payload\",\n      });\n    }\n  })\n);\n\nEventsRouter.get(\n  \"/upcoming\",\n  useHMAC,\n  safeRequest(async (req, res) => {\n    const events = await eventsController.getUpcomingEvents();\n    return {\n      data: events,\n    };\n  })\n);\n\nEventsRouter.get(\n  \"/today\",\n  useHMAC,\n  safeRequest(async (req, res) => {\n    const events = await eventsController.getEventsForToday();\n    return {\n      data: events,\n    };\n  })\n);\n\nEventsRouter.get(\n  \"/past\",\n  useHMAC,\n  safeRequest(async (req, res) => {\n    const events = await eventsController.getPastEvents();\n\n    return {\n      data: events,\n    };\n  })\n);\n\ntype UploadedFile = {\n  fieldName: string;\n  originalFilename: string;\n  path: string;\n  headers: Record<string, string>;\n  size: number;\n  name: string;\n  type: string;\n};\n\nEventsRouter.post(\n  \"/upload_media\",\n  useJWT([\"admin\"]),\n  formData.parse({}),\n  safeRequest(async (req, res) => {\n    const files = (req as any).files.medias as UploadedFile[] | undefined;\n    if (!files || files.length === 0) {\n      return safeReturnTransaction(transactionError(FAIL_REASONS.BAD_REQUEST));\n    }\n\n    const uploadPromises = files.map(async (file) => {\n      const fileName = `${file.originalFilename}`;\n      const filePath = `events/${req.body.folder}/${fileName}`;\n\n      await uploadToBucket(filePath, await fs.readFile(file.path));\n\n      return filePath;\n    });\n\n    const uploadedFiles = await Promise.all(uploadPromises);\n\n    console.log(uploadedFiles);\n\n    const updateTransaction = await eventsController.updateEvent(\n      req.body.eventId,\n      {\n        medias: uploadedFiles,\n      }\n    );\n\n    return safeReturnTransaction(updateTransaction);\n\n    return {\n      success: true,\n    };\n  })\n);\n\nEventsRouter.post(\n  \"/random_atendee\",\n  useJWT([\"admin\"]),\n  safeRequest(async (req, res) => {\n    const { eventId } = V.validate(\n      {\n        eventId: V.string,\n      },\n      req.body\n    );\n\n    const { attendees } = await eventsController.getEventById(eventId);\n\n    const radom_atendee =\n      attendees[Math.round(Math.random() * attendees.length)];\n\n    const atendeeData = await userController.getUserById(radom_atendee);\n\n    return atendeeData;\n  })\n);\n\nEventsRouter.post(\n  \"/confirm_atendees\",\n  useJWT([\"admin\"]),\n  safeRequest(async (req, res) => {\n    const { eventId } = V.validate(\n      {\n        eventId: V.string,\n      },\n      req.body\n    );\n\n    const { attendees } = await eventsController.getEventById(eventId);\n\n    const result = await Promise.all(\n      attendees.map((id) => {\n        userController.updateUser(id, {\n          confirmed: true,\n        });\n      })\n    );\n\n    return {\n      success: true,\n      attendees: attendees.length,\n    };\n  })\n);\n\nEventsRouter.get(\n  \"/atendees\",\n  useJWT([\"admin\"]),\n  safeRequest(async (req, res) => {\n    const { eventId } = V.validate(\n      {\n        eventId: V.string,\n      },\n      req.query as Record<string, string>\n    );\n\n    const { attendees } = await eventsController.getEventById(eventId);\n\n    const result = await Promise.all(attendees.map(userController.getUserById));\n\n    return {\n      success: true,\n      attendees: result.map((user) => ({\n        name: user.name,\n        phone: user.phoneNumber,\n      })),\n    };\n  })\n);\n\nEventsRouter.get(\n  \"/details\",\n  // useHMAC,\n  safeRequest(async (req, res) => {\n    const { id } = V.validate(\n      {\n        id: V.string,\n      },\n      req.query as Record<string, string>\n    );\n\n    const event = await eventsController.getEventById(id);\n\n    return {\n      name: event.name,\n      description: event.description,\n      date: event.date,\n      attendees: event.attendees.length,\n      location: event.location,\n\n      bannerUrl: event.bannerUrl,\n      medias: event.medias.map((name) => ({\n        url: name,\n        type: Boolean(mime.lookup(name))\n          ? (mime.lookup(name) as string).includes(\"image\")\n            ? \"image\"\n            : \"video\"\n          : \"unknown\",\n      })),\n    };\n  })\n);\n\nEventsRouter.post(\n  \"/invite_confirmed\",\n  useJWT([\"admin\"]),\n  json(),\n  safeRequest(async (req, res) => {\n    const allConfirmedUsers = await userController.getAllUsers(true);\n\n    const allConfirmedContacts = allConfirmedUsers.map((user) => {\n      const sanitizedPhone = `55${user.phoneNumber.replace(/[\\D]/g, \"\")}`;\n      const contactId = `${sanitizedPhone}@s.whatsapp.net`;\n      return [user.name, contactId] as const;\n    });\n\n    const messages = [\n      eventConfirmation1,\n      eventConfirmation2,\n      eventConfirmation3,\n      eventConfirmation4,\n    ];\n\n    const postMessages = [\n      inviteFriendMessage1,\n      inviteFriendMessage2,\n      inviteFriendMessage3,\n    ];\n\n    sendMessageToContactList({\n      contacts: allConfirmedContacts,\n      messages: messages,\n      post_messages: postMessages,\n    });\n  })\n);\n\nexport default EventsRouter;\n"],"mappings":"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","ignoreList":[]}