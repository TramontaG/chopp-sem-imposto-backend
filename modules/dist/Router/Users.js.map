{"version":3,"file":"Users.js","names":["_express","require","_verifyHMAC","_SafeRequest","_userController","_interopRequireDefault","_SafeDatabaseTransaction","V","_interopRequireWildcard","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","UserRouter","Router","useHMAC","safeRequest","req","res","confirmed","validate","booleanAsString","optional","params","totalUsersTransaction","userController","getTotalUsers","Boolean","setHeader","safeReturnTransaction","_default","exports"],"sources":["../../src/Router/Users.ts"],"sourcesContent":["import { Router } from \"express\";\nimport { useHMAC } from \"../JWT/verifyHMAC\";\nimport { safeRequest } from \"../Util/SafeRequest\";\nimport userController from \"../database/controllers/userController\";\nimport { safeReturnTransaction } from \"../Util/SafeDatabaseTransaction\";\nimport * as V from \"../Util/ZodValidation\";\n\nconst UserRouter = Router();\n\nUserRouter.get(\n  \"/total\",\n  useHMAC,\n  safeRequest(async (req, res) => {\n    const { confirmed } = V.validate(\n      { confirmed: V.booleanAsString.optional() },\n      req.params\n    );\n\n    const totalUsersTransaction = await userController.getTotalUsers(\n      Boolean(confirmed)\n    );\n\n    // avoid cacheing the result\n    res.setHeader(\n      \"Cache-Control\",\n      \"no-store, no-cache, must-revalidate, max-age=0, s-maxage=0\"\n    );\n    res.setHeader(\"Pragma\", \"no-cache\");\n    res.setHeader(\"Expires\", \"0\");\n\n    return safeReturnTransaction(totalUsersTransaction);\n  })\n);\n\nexport default UserRouter;\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,WAAA,GAAAD,OAAA;AACA,IAAAE,YAAA,GAAAF,OAAA;AACA,IAAAG,eAAA,GAAAC,sBAAA,CAAAJ,OAAA;AACA,IAAAK,wBAAA,GAAAL,OAAA;AACA,IAAAM,CAAA,GAAAC,uBAAA,CAAAP,OAAA;AAA2C,SAAAO,wBAAAC,CAAA,EAAAC,CAAA,6BAAAC,OAAA,MAAAC,CAAA,OAAAD,OAAA,IAAAE,CAAA,OAAAF,OAAA,YAAAH,uBAAA,YAAAA,CAAAC,CAAA,EAAAC,CAAA,SAAAA,CAAA,IAAAD,CAAA,IAAAA,CAAA,CAAAK,UAAA,SAAAL,CAAA,MAAAM,CAAA,EAAAC,CAAA,EAAAC,CAAA,KAAAC,SAAA,QAAAC,OAAA,EAAAV,CAAA,iBAAAA,CAAA,uBAAAA,CAAA,yBAAAA,CAAA,SAAAQ,CAAA,MAAAF,CAAA,GAAAL,CAAA,GAAAG,CAAA,GAAAD,CAAA,QAAAG,CAAA,CAAAK,GAAA,CAAAX,CAAA,UAAAM,CAAA,CAAAM,GAAA,CAAAZ,CAAA,GAAAM,CAAA,CAAAO,GAAA,CAAAb,CAAA,EAAAQ,CAAA,gBAAAP,CAAA,IAAAD,CAAA,gBAAAC,CAAA,OAAAa,cAAA,CAAAC,IAAA,CAAAf,CAAA,EAAAC,CAAA,OAAAM,CAAA,IAAAD,CAAA,GAAAU,MAAA,CAAAC,cAAA,KAAAD,MAAA,CAAAE,wBAAA,CAAAlB,CAAA,EAAAC,CAAA,OAAAM,CAAA,CAAAK,GAAA,IAAAL,CAAA,CAAAM,GAAA,IAAAP,CAAA,CAAAE,CAAA,EAAAP,CAAA,EAAAM,CAAA,IAAAC,CAAA,CAAAP,CAAA,IAAAD,CAAA,CAAAC,CAAA,WAAAO,CAAA,KAAAR,CAAA,EAAAC,CAAA;AAAA,SAAAL,uBAAAI,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAK,UAAA,GAAAL,CAAA,KAAAU,OAAA,EAAAV,CAAA;AAE3C,MAAMmB,UAAU,GAAG,IAAAC,eAAM,EAAC,CAAC;AAE3BD,UAAU,CAACP,GAAG,CACZ,QAAQ,EACRS,mBAAO,EACP,IAAAC,wBAAW,EAAC,OAAOC,GAAG,EAAEC,GAAG,KAAK;EAC9B,MAAM;IAAEC;EAAU,CAAC,GAAG3B,CAAC,CAAC4B,QAAQ,CAC9B;IAAED,SAAS,EAAE3B,CAAC,CAAC6B,eAAe,CAACC,QAAQ,CAAC;EAAE,CAAC,EAC3CL,GAAG,CAACM,MACN,CAAC;EAED,MAAMC,qBAAqB,GAAG,MAAMC,uBAAc,CAACC,aAAa,CAC9DC,OAAO,CAACR,SAAS,CACnB,CAAC;;EAED;EACAD,GAAG,CAACU,SAAS,CACX,eAAe,EACf,4DACF,CAAC;EACDV,GAAG,CAACU,SAAS,CAAC,QAAQ,EAAE,UAAU,CAAC;EACnCV,GAAG,CAACU,SAAS,CAAC,SAAS,EAAE,GAAG,CAAC;EAE7B,OAAO,IAAAC,8CAAqB,EAACL,qBAAqB,CAAC;AACrD,CAAC,CACH,CAAC;AAAC,IAAAM,QAAA,GAAAC,OAAA,CAAA3B,OAAA,GAEaS,UAAU","ignoreList":[]}