{"version":3,"file":"ZodValidation.js","names":["Zod","_interopRequireWildcard","require","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","createCustomError","code","variant","message","error","errorType","exports","createTransactionError","reason","data","isDefaultError","getPropertyListFromObject","obj","entries","reduce","acc","key","value","push","validate","zod","object","query","safeParse","success","fields","issues","literalSchema","union","string","number","boolean","null","jsonSchema","lazy","array","record","stringArray","optional","shape","any","or","shape1","shape2","refine","anyObject","enums","values","enum","typeNull","phoneRegex","cpfRegex","cnpjRegex","brazilianIdRegex","cepRegex","phone","regex","cpf","cnpj","brazilianId","cep","emoji","url","email","document","booleanAsString","toLowerCase","startsWith","endsWith","length","transform"],"sources":["../../src/Util/ZodValidation.ts"],"sourcesContent":["import * as Zod from \"zod\";\n\ntype DefaultError = {\n  code: number;\n  error: ValidationError | TransactionError | CustomError;\n};\n\nexport type ValidationError = {\n  errorType: \"Validation\";\n  fields: {\n    path: string[];\n    message: string;\n  }[];\n};\n\nexport const createCustomError = (\n  code: number,\n  variant: string,\n  message: string\n) => ({\n  code,\n  error: {\n    errorType: \"Custom\",\n    variant,\n    message,\n  },\n});\n\nexport type CustomError = {\n  errorType: \"Custom\";\n  variant: string;\n  message: string;\n};\n\nexport type TransactionError = {\n  errorType: \"Transaction\";\n  message: string;\n  data: any;\n};\n\nexport const createTransactionError = (\n  code: number,\n  reason: string,\n  data: any\n): DefaultError => ({\n  code,\n  error: {\n    errorType: \"Transaction\",\n    message: reason,\n    data,\n  },\n});\n\nexport const isDefaultError = (e: any): e is DefaultError => {\n  return !!e && !!e.code;\n};\n\nexport const getPropertyListFromObject = <T extends Object>(obj: T) => {\n  return Object.entries(obj).reduce(\n    (acc, [key, value]) => {\n      acc[0].push(key);\n      acc[1].push(value);\n      return acc;\n    },\n    [[] as string[], [] as T[keyof T][]] as const\n  );\n};\n\nexport const validate = <Z extends Zod.ZodRawShape>(zod: Z, obj: Json) => {\n  const object = Zod.object(zod);\n  const query = object.safeParse(obj);\n  if (!query.success) {\n    throw {\n      code: 400,\n      error: {\n        errorType: \"Validation\",\n        fields: query.error.issues,\n      },\n    };\n  } else {\n    return query.data;\n  }\n};\n\n// code copied from https://zod.dev/?id=json-type\nconst literalSchema = Zod.union([\n  Zod.string(),\n  Zod.number(),\n  Zod.boolean(),\n  Zod.null(),\n]);\ntype Literal = Zod.infer<typeof literalSchema>;\nexport type Json = Literal | { [key: string]: Json } | Json[];\nexport const jsonSchema: Zod.ZodType<Json> = Zod.lazy(() =>\n  Zod.union([literalSchema, Zod.array(jsonSchema), Zod.record(jsonSchema)])\n);\n\nexport const string = Zod.string();\nexport const number = Zod.number();\nexport const stringArray = Zod.array(string);\nexport const optional = <Shape extends Zod.ZodType>(shape: Shape) =>\n  shape.optional();\nexport const boolean = Zod.boolean();\nexport const any = Zod.any();\nexport const array = <Shape extends Zod.ZodType>(shape: Shape) =>\n  Zod.array(shape);\nexport const or = <Shape1 extends Zod.ZodType, Shape2 extends Zod.ZodType>(\n  shape1: Shape1,\n  shape2: Shape2,\n  message?: string\n) => {\n  return shape1.or(shape2).refine(\n    () => {\n      return true;\n    },\n    {\n      message,\n    }\n  );\n};\nexport const object = <Shape extends Zod.ZodRawShape>(obj: Shape) =>\n  Zod.object(obj);\nexport const anyObject = jsonSchema;\n\nexport const enums = <const Values extends readonly [string, ...string[]]>(\n  values: Values\n) => Zod.enum(values);\n\nexport const typeNull = Zod.null();\nexport const phoneRegex = /^\\(([0-9]){2}\\)([0-9]){4,5}-([0-9]){4}$/;\nexport const cpfRegex = /^[0-9]{3}\\.[0-9]{3}\\.[0-9]{3}-[0-9]{2}$/;\nexport const cnpjRegex = /^[0-9]{2}\\.[0-9]{3}\\.[0-9]{3}\\/[0-9]{4}-[0-9]{2}$/;\nexport const brazilianIdRegex = /^[0-9]{2}\\.[0-9]{3}\\.[0-9]{3}-[0-9]$/;\nexport const cepRegex = /^[0-9]{5}-[0-9]{3}$/;\n\nexport const phone = string.regex(\n  phoneRegex,\n  \"Deve ser um telefone válido, formato (99)99999-9999 or (99)9999-9999\"\n);\nexport const cpf = string.regex(\n  cpfRegex,\n  \"Deve ser um CPF válido, formato 999.999.999-99\"\n);\nexport const cnpj = string.regex(\n  cnpjRegex,\n  \"Deve ser um CNPJ Válido, formato 99.999.999/9999-99\"\n);\nexport const brazilianId = string.regex(\n  brazilianIdRegex,\n  \"Deve ser um RG válido, formato 99.999.999-*\"\n);\nexport const cep = string.regex(\n  cepRegex,\n  \"Deve ser um CEP válido, formato 99999-999\"\n);\nexport const emoji = string.emoji(\"Deve ser um Emoji\");\nexport const url = string.url(\"URL inválida\");\nexport const email = string.email(\"Email inválido\");\nexport const document = string\n  .regex(cpfRegex, \"Deve ser um CPF ou um CNPJ válido\")\n  .or(string.regex(cnpjRegex));\n\n/**\n * Accepts strings that when lowercase results to \"true\" or \"false\", outputs the proper boolean value\n */\nexport const booleanAsString = string\n  .toLowerCase()\n  .startsWith(\"true\")\n  .endsWith(\"true\")\n  .length(4)\n  .transform(() => true)\n  .or(\n    string\n      .toLowerCase()\n      .startsWith(\"false\")\n      .endsWith(\"false\")\n      .length(5)\n      .transform(() => false)\n  );\n"],"mappings":"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","ignoreList":[]}