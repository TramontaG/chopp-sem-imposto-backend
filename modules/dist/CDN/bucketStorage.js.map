{"version":3,"file":"bucketStorage.js","names":["_storage","require","_Firebase","_interopRequireDefault","e","__esModule","default","bucket","exports","getStorage","firebase","process","env","FIREBASE_BUCKET","uploadToBucket","fileName","fileAsBuffer","file","save","getFileUrl","fileRef","getDownloadURL","downloadFile","Promise","resolve","reject","download","err","content"],"sources":["../../src/CDN/bucketStorage.ts"],"sourcesContent":["import { getDownloadURL, getStorage } from \"firebase-admin/storage\";\nimport firebase from \"../Firebase\";\n\nexport const bucket = getStorage(firebase).bucket(process.env.FIREBASE_BUCKET);\n\nexport const uploadToBucket = async (\n  fileName: string,\n  fileAsBuffer: Buffer\n) => {\n  await bucket.file(fileName).save(fileAsBuffer);\n  return getFileUrl(fileName);\n};\n\nexport const getFileUrl = async (fileName: string) => {\n  const fileRef = await bucket.file(fileName);\n  return getDownloadURL(fileRef);\n};\n\nexport const downloadFile = async (fileName: string): Promise<Buffer> => {\n  const fileRef = await bucket.file(fileName);\n  return new Promise((resolve, reject) => {\n    fileRef.download({}, (err, content) => {\n      if (err) {\n        reject(err);\n      }\n      resolve(content);\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,SAAA,GAAAC,sBAAA,CAAAF,OAAA;AAAmC,SAAAE,uBAAAC,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAE5B,MAAMG,MAAM,GAAAC,OAAA,CAAAD,MAAA,GAAG,IAAAE,mBAAU,EAACC,iBAAQ,CAAC,CAACH,MAAM,CAACI,OAAO,CAACC,GAAG,CAACC,eAAe,CAAC;AAEvE,MAAMC,cAAc,GAAG,MAAAA,CAC5BC,QAAgB,EAChBC,YAAoB,KACjB;EACH,MAAMT,MAAM,CAACU,IAAI,CAACF,QAAQ,CAAC,CAACG,IAAI,CAACF,YAAY,CAAC;EAC9C,OAAOG,UAAU,CAACJ,QAAQ,CAAC;AAC7B,CAAC;AAACP,OAAA,CAAAM,cAAA,GAAAA,cAAA;AAEK,MAAMK,UAAU,GAAG,MAAOJ,QAAgB,IAAK;EACpD,MAAMK,OAAO,GAAG,MAAMb,MAAM,CAACU,IAAI,CAACF,QAAQ,CAAC;EAC3C,OAAO,IAAAM,uBAAc,EAACD,OAAO,CAAC;AAChC,CAAC;AAACZ,OAAA,CAAAW,UAAA,GAAAA,UAAA;AAEK,MAAMG,YAAY,GAAG,MAAOP,QAAgB,IAAsB;EACvE,MAAMK,OAAO,GAAG,MAAMb,MAAM,CAACU,IAAI,CAACF,QAAQ,CAAC;EAC3C,OAAO,IAAIQ,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCL,OAAO,CAACM,QAAQ,CAAC,CAAC,CAAC,EAAE,CAACC,GAAG,EAAEC,OAAO,KAAK;MACrC,IAAID,GAAG,EAAE;QACPF,MAAM,CAACE,GAAG,CAAC;MACb;MACAH,OAAO,CAACI,OAAO,CAAC;IAClB,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACpB,OAAA,CAAAc,YAAA,GAAAA,YAAA","ignoreList":[]}