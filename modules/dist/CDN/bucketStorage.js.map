{"version":3,"file":"bucketStorage.js","names":["_storage","require","_firebaseAdmin","_interopRequireDefault","e","__esModule","default","firebase","admin","initializeApp","credential","applicationDefault","bucket","exports","getStorage","process","env","FIREBASE_BUCKET","uploadToBucket","fileName","fileAsBuffer","file","save","getFileUrl","fileRef","getDownloadURL","downloadFile","Promise","resolve","reject","download","err","content"],"sources":["../../src/CDN/bucketStorage.ts"],"sourcesContent":["import { getDownloadURL, getStorage } from \"firebase-admin/storage\";\nimport admin from \"firebase-admin\";\n\nconst firebase = admin.initializeApp({\n  credential: admin.credential.applicationDefault(),\n});\n\nexport const bucket = getStorage(firebase).bucket(process.env.FIREBASE_BUCKET);\n\nexport const uploadToBucket = async (\n  fileName: string,\n  fileAsBuffer: Buffer\n) => {\n  await bucket.file(fileName).save(fileAsBuffer);\n  return getFileUrl(fileName);\n};\n\nexport const getFileUrl = async (fileName: string) => {\n  const fileRef = await bucket.file(fileName);\n  return getDownloadURL(fileRef);\n};\n\nexport const downloadFile = async (fileName: string): Promise<Buffer> => {\n  const fileRef = await bucket.file(fileName);\n  return new Promise((resolve, reject) => {\n    fileRef.download({}, (err, content) => {\n      if (err) {\n        reject(err);\n      }\n      resolve(content);\n    });\n  });\n};\n"],"mappings":";;;;;;AAAA,IAAAA,QAAA,GAAAC,OAAA;AACA,IAAAC,cAAA,GAAAC,sBAAA,CAAAF,OAAA;AAAmC,SAAAE,uBAAAC,CAAA,WAAAA,CAAA,IAAAA,CAAA,CAAAC,UAAA,GAAAD,CAAA,KAAAE,OAAA,EAAAF,CAAA;AAEnC,MAAMG,QAAQ,GAAGC,sBAAK,CAACC,aAAa,CAAC;EACnCC,UAAU,EAAEF,sBAAK,CAACE,UAAU,CAACC,kBAAkB,CAAC;AAClD,CAAC,CAAC;AAEK,MAAMC,MAAM,GAAAC,OAAA,CAAAD,MAAA,GAAG,IAAAE,mBAAU,EAACP,QAAQ,CAAC,CAACK,MAAM,CAACG,OAAO,CAACC,GAAG,CAACC,eAAe,CAAC;AAEvE,MAAMC,cAAc,GAAG,MAAAA,CAC5BC,QAAgB,EAChBC,YAAoB,KACjB;EACH,MAAMR,MAAM,CAACS,IAAI,CAACF,QAAQ,CAAC,CAACG,IAAI,CAACF,YAAY,CAAC;EAC9C,OAAOG,UAAU,CAACJ,QAAQ,CAAC;AAC7B,CAAC;AAACN,OAAA,CAAAK,cAAA,GAAAA,cAAA;AAEK,MAAMK,UAAU,GAAG,MAAOJ,QAAgB,IAAK;EACpD,MAAMK,OAAO,GAAG,MAAMZ,MAAM,CAACS,IAAI,CAACF,QAAQ,CAAC;EAC3C,OAAO,IAAAM,uBAAc,EAACD,OAAO,CAAC;AAChC,CAAC;AAACX,OAAA,CAAAU,UAAA,GAAAA,UAAA;AAEK,MAAMG,YAAY,GAAG,MAAOP,QAAgB,IAAsB;EACvE,MAAMK,OAAO,GAAG,MAAMZ,MAAM,CAACS,IAAI,CAACF,QAAQ,CAAC;EAC3C,OAAO,IAAIQ,OAAO,CAAC,CAACC,OAAO,EAAEC,MAAM,KAAK;IACtCL,OAAO,CAACM,QAAQ,CAAC,CAAC,CAAC,EAAE,CAACC,GAAG,EAAEC,OAAO,KAAK;MACrC,IAAID,GAAG,EAAE;QACPF,MAAM,CAACE,GAAG,CAAC;MACb;MACAH,OAAO,CAACI,OAAO,CAAC;IAClB,CAAC,CAAC;EACJ,CAAC,CAAC;AACJ,CAAC;AAACnB,OAAA,CAAAa,YAAA,GAAAA,YAAA","ignoreList":[]}